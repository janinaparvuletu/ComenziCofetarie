<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>

<div th:replace="fragments/navbar :: navbar"></div>

<h2 th:text="${mode == 'MY' ? 'Comenzile mele' : 'Toate comenzile'}"></h2>

<div th:if="${error}" style="color:red; margin:10px 0;" th:text="${error}"></div>
<div th:if="${success}" style="color:green; margin:10px 0;" th:text="${success}"></div>
<div th:if="${info}" style="color:#555; margin:10px 0;" th:text="${info}"></div>

<div th:if="${#lists.isEmpty(orders)}" style="margin:15px 0; color:#555;">
  Nu există comenzi de afișat.
</div>

<table th:if="${!#lists.isEmpty(orders)}" border="1" cellpadding="6" cellspacing="0">
  <tr>
    <th>ID</th>
    <th>Deadline</th>
    <th>Status</th>
    <th>Blat</th>
    <th>Cremă</th>
    <th>Glazură</th>
    <th>Mesaj</th>

    <!-- doar pentru ALL (staff) -->
    <th sec:authorize="hasAnyRole('ANGAJAT','MANAGER')">Client</th>
    <th sec:authorize="hasAnyRole('ANGAJAT','MANAGER')">Telefon</th>
    <th sec:authorize="hasAnyRole('ANGAJAT','MANAGER')">Acțiuni</th>
  </tr>

  <tr th:each="o : ${orders}">
    <td th:text="${o.id}"></td>
    <td th:text="${o.deadline}"></td>
    <td th:text="${o.status}"></td>
    <td th:text="${o.blat}"></td>
    <td th:text="${o.crema}"></td>
    <td th:text="${o.glazura}"></td>
    <td th:text="${o.mesajTort}"></td>

    <td sec:authorize="hasAnyRole('ANGAJAT','MANAGER')" th:text="${o.user.username}"></td>
    <td sec:authorize="hasAnyRole('ANGAJAT','MANAGER')" th:text="${o.user.nrTelefon}"></td>

    <td sec:authorize="hasAnyRole('ANGAJAT','MANAGER')">
      <a th:href="@{/orders/{id}(id=${o.id})}">Detalii</a>
    </td>
  </tr>
</table>

</body>
</html>
